<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dog Image Viewer</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main class="container">
      <header>
        <h1>Dog Image Viewer</h1>
        <p>
          Select a breed or enter a breed name to view a specific dog image!
        </p>
      </header>

      <section>
        <select id="breedSelect" onchange="fetchBreedImage()">
          <option value="">Select a Breed</option>
        </select>
        <br />

        <input type="text" id="breedInput" placeholder="Enter breed name" />
        <button onclick="fetchBreedImageByName()">Search by Breed Name</button>

        <img id="dogImage" src="" alt="Dog Image" />
        <button onclick="fetchRandomDogImage()">Get Random Dog Image</button>
      </section>

      <footer>
        <p>
          Powered by
          <a href="https://thedogapi.com" target="_blank">The Dog API</a>
        </p>
      </footer>
    </main>

    <script>
      const apiKey = "live_2titjByn291sT9XgC7Q4qDv8n40x8Ndrlm2PhkDCH5GfOn5wD3bvTQXPIUt87PHh";
      const apiUrl = "https://api.thedogapi.com/v1/images/search";
      const breedUrl = "https://api.thedogapi.com/v1/breeds";

      async function initializeBreeds() {
        try {
          const response = await fetch(breedUrl, {
            headers: {
              "x-api-key": apiKey,
            },
          });
          const breeds = await response.json();
          const breedSelect = document.getElementById("breedSelect");

          breeds.forEach((breed) => {
            const option = document.createElement("option");
            option.value = breed.id;
            option.text = breed.name;
            breedSelect.appendChild(option);
          });
        } catch (error) {
          console.error("Error fetching breeds:", error);
        }
      }

      function fetchRandomDogImage() {
        fetch(apiUrl, {
          headers: {
            "x-api-key": apiKey,
          },
        })
          .then((response) => response.json())
          .then((data) => {
            const imageUrl = data[0].url;
            document.getElementById("dogImage").src = imageUrl;
          })
          .catch((error) => {
            console.error("Error fetching random dog image:", error);
            alert("Failed to fetch random dog image.");
          });
      }

      function fetchBreedImage() {
        const breedId = document.getElementById("breedSelect").value;
        if (!breedId) return;

        fetch(`${apiUrl}?breed_id=${breedId}`, {
          headers: {
            "x-api-key": apiKey,
          },
        })
          .then((response) => response.json())
          .then((data) => {
            const imageUrl = data[0].url;
            document.getElementById("dogImage").src = imageUrl;
          })
          .catch((error) => {
            console.error("Error fetching breed image:", error);
            alert("Failed to fetch breed image.");
          });
      }

      function fetchBreedImageByName() {
        const breedName = document
          .getElementById("breedInput")
          .value.toLowerCase();
        fetch(breedUrl, {
          headers: {
            "x-api-key": apiKey,
          },
        })
          .then((response) => response.json())
          .then((breeds) => {
            const breed = breeds.find(
              (b) => b.name.toLowerCase() === breedName
            );
            if (breed) {
              fetch(`${apiUrl}?breed_id=${breed.id}`, {
                headers: {
                  "x-api-key": apiKey,
                },
              })
                .then((response) => response.json())
                .then((data) => {
                  const imageUrl = data[0].url;
                  document.getElementById("dogImage").src = imageUrl;
                });
            } else {
              alert("Breed not found. Please try a different name.");
            }
          })
          .catch((error) => {
            console.error("Error fetching breed by name:", error);
            alert("Failed to fetch breed image by name.");
          });
      }

      initializeBreeds();
      fetchRandomDogImage();
    </script>
  </body>
</html>
